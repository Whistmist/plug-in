var port=null;var responseMessage=null;var responseFunction=null;chrome.runtime.onMessage.addListener(function(c,b,a){if(c.type=="launch"){connectToNativeHost(c.message)}else{if(c.type=="msg"){MyPostMsg(c.message);responseFunction=a}else{if(c.type=="exit"){MyPostMsg(c.message)}}}return true});function onDisconnected(){port=null;responseMessage=null;responseFunction=null}function MyPostMsg(a){if(port){port.postMessage(a)}}function onNativeMessage(a){responseMessage=JSON.stringify(a);if(responseMessage=='"KeepLive"'){port.postMessage(a)}else{if(responseFunction!=null){responseFunction({resp:responseMessage})}}}function connectToNativeHost(b){var a="com.cntv.live2";console.log(a);port=chrome.runtime.connectNative(a);port.onMessage.addListener(onNativeMessage);port.onDisconnect.addListener(onDisconnected);port.postMessage(b)};
